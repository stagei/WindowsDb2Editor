<Window x:Class="WindowsDb2Editor.Dialogs.CrossDatabaseComparisonDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.modernwpf.com/2019"
        ui:WindowHelper.UseModernWindowStyle="True"
        ui:TitleBar.IsIconVisible="True"
        Title="Cross-Database Schema Comparison"
        Icon="pack://application:,,,/Resources/dEdge.ico"
        Width="1000"
        Height="750"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="ðŸ” Cross-Database Schema Comparison" FontSize="24" FontWeight="Bold" Margin="0,0,0,10"/>
        
        <TextBlock Grid.Row="1" Text="Compare a schema across two different database connections" 
                   FontSize="12" Foreground="Gray" Margin="0,0,0,15"/>

        <!-- Connection Selection -->
        <Grid Grid.Row="2" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="60"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Source Connection -->
            <GroupBox Grid.Column="0" Header="ðŸ“¥ Source Database" Padding="10">
                <StackPanel>
                    <TextBlock Text="Connection Profile:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <ComboBox x:Name="SourceConnectionComboBox" Margin="0,0,0,10" SelectionChanged="SourceConnection_SelectionChanged"/>
                    
                    <TextBlock Text="Schema:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <ComboBox x:Name="SourceSchemaComboBox" Margin="0,0,0,5"/>
                    
                    <TextBlock x:Name="SourceInfoText" Text="Select a connection profile" FontSize="11" Foreground="Gray"/>
                </StackPanel>
            </GroupBox>

            <StackPanel Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="â†’" FontSize="32" FontWeight="Bold" Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
                <TextBlock Text="vs" FontSize="14" Foreground="Gray" HorizontalAlignment="Center"/>
            </StackPanel>

            <!-- Target Connection -->
            <GroupBox Grid.Column="2" Header="ðŸ“¤ Target Database" Padding="10">
                <StackPanel>
                    <TextBlock Text="Connection Profile:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <ComboBox x:Name="TargetConnectionComboBox" Margin="0,0,0,10" SelectionChanged="TargetConnection_SelectionChanged"/>
                    
                    <TextBlock Text="Schema:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <ComboBox x:Name="TargetSchemaComboBox" Margin="0,0,0,5"/>
                    
                    <TextBlock x:Name="TargetInfoText" Text="Select a connection profile" FontSize="11" Foreground="Gray"/>
                </StackPanel>
            </GroupBox>
        </Grid>

        <!-- Results TabControl -->
        <TabControl Grid.Row="3" x:Name="ResultsTabControl" Visibility="Collapsed">
            <TabItem Header="ðŸ“Š Summary">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="15">
                        <TextBlock x:Name="SummaryText" TextWrapping="Wrap" FontSize="14"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="âž• Only in Source">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" x:Name="OnlyInSourceHeader" Text="Tables that exist only in the source database:" Margin="0,0,0,10"/>
                    <ListBox Grid.Row="1" x:Name="OnlyInSourceList" FontFamily="Consolas"/>
                </Grid>
            </TabItem>

            <TabItem Header="âž– Only in Target">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" x:Name="OnlyInTargetHeader" Text="Tables that exist only in the target database:" Margin="0,0,0,10"/>
                    <ListBox Grid.Row="1" x:Name="OnlyInTargetList" FontFamily="Consolas"/>
                </Grid>
            </TabItem>

            <TabItem Header="âœ… In Both">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Text="Tables that exist in both databases (may have different structures):" Margin="0,0,0,10"/>
                    <ListBox Grid.Row="1" x:Name="InBothList" FontFamily="Consolas"/>
                </Grid>
            </TabItem>

            <TabItem Header="âš ï¸ Column Differences">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Text="Tables with column differences:" Margin="0,0,0,10"/>
                    <DataGrid Grid.Row="1" x:Name="DifferencesGrid" AutoGenerateColumns="True" IsReadOnly="True"
                              GridLinesVisibility="All" CanUserAddRows="False"/>
                </Grid>
            </TabItem>

            <TabItem Header="ðŸ“œ Migration DDL">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Text="Generated DDL to migrate from source to target:" Margin="0,0,0,10"/>
                    <TextBox Grid.Row="1" x:Name="MigrationDdlTextBox" IsReadOnly="True" AcceptsReturn="True"
                             TextWrapping="NoWrap" VerticalScrollBarVisibility="Auto"
                             HorizontalScrollBarVisibility="Auto" FontFamily="Consolas"
                             FontSize="12"/>
                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                        <Button Content="ðŸ“‹ Copy to Clipboard" Click="CopyDdl_Click" Padding="15,5" Margin="0,0,10,0"/>
                        <Button Content="ðŸ’¾ Save to File..." Click="SaveDdl_Click" Padding="15,5"/>
                    </StackPanel>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Progress and Buttons -->
        <Grid Grid.Row="4" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <ProgressBar Grid.Column="0" x:Name="ProgressBar" Height="20" Margin="0,0,15,0" Visibility="Collapsed"/>
            
            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="CompareButton" Content="ðŸ” Compare Schemas" Width="150" Margin="0,0,10,0" 
                        Click="Compare_Click" Style="{StaticResource AccentButtonStyle}"/>
                <Button Content="Close" Width="100" Click="Close_Click"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>

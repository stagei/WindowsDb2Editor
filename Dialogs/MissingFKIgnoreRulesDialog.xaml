<Window x:Class="WindowsDb2Editor.Dialogs.MissingFKIgnoreRulesDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.modernwpf.com/2019"
        ui:WindowHelper.UseModernWindowStyle="True"
        Title="Ignore Rules Editor"
        Icon="pack://application:,,,/Resources/dEdge.ico"
        Width="700"
        Height="650"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize">
    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Title -->
        <TextBlock Grid.Row="0" Text="Edit Ignore Rules" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>
        
        <!-- History Dropdown with Preview -->
        <Grid Grid.Row="1" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <TextBlock Grid.Column="0" Text="Load from history:" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <ComboBox x:Name="IgnoreHistoryComboBox" Grid.Column="1" 
                    SelectionChanged="IgnoreHistoryComboBox_SelectionChanged"
                    ui:ControlHelper.PlaceholderText="Select previous ignore list...">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Vertical" Margin="5">
                            <TextBlock Text="{Binding Name}" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding SavedAt, StringFormat='Saved: {0:yyyy-MM-dd HH:mm}'}" 
                                     FontSize="11" Foreground="Gray" Margin="0,2,0,0"/>
                            <TextBlock Text="{Binding Preview}" FontSize="10" Foreground="#AAAAAA" 
                                     TextWrapping="Wrap" Margin="0,2,0,0" MaxHeight="40"/>
                        </StackPanel>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
            <Button Grid.Column="2" Content="Save Current" Click="SaveIgnoreConfig_Click" 
                    Padding="8,4" Margin="10,0,0,0"/>
        </Grid>
        
        <!-- Ignore Column List -->
        <GroupBox Grid.Row="2" Header="Ignore Columns (Schema.Table.Column)" Margin="0,0,0,10">
            <DataGrid x:Name="IgnoreColumnsGrid" 
                    AutoGenerateColumns="False" CanUserAddRows="True" CanUserDeleteRows="True"
                    HeadersVisibility="Column" GridLinesVisibility="All" Margin="5">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Schema" Binding="{Binding Schema}" Width="150"/>
                        <DataGridTextColumn Header="Table" Binding="{Binding Table}" Width="150"/>
                        <DataGridTextColumn Header="Column" Binding="{Binding Name}" Width="*"/>
                    </DataGrid.Columns>
            </DataGrid>
        </GroupBox>
        
        <!-- Ignore Column Patterns -->
        <GroupBox Grid.Row="3" Header="Ignore Column Patterns (Regex - one per line)" Margin="0,0,0,10">
            <TextBox x:Name="IgnorePatternsTextBox" AcceptsReturn="True" TextWrapping="Wrap" 
                    Height="100" VerticalScrollBarVisibility="Auto" Margin="5"
                    ui:ControlHelper.PlaceholderText="One pattern per line, e.g., ^TMP_, _HASH$"/>
        </GroupBox>
        
        <!-- Ignore Data Types -->
        <GroupBox Grid.Row="4" Header="Ignore Data Types (comma-separated)" Margin="0,0,0,10">
            <TextBox x:Name="IgnoreDataTypesTextBox" Margin="5"
                    ui:ControlHelper.PlaceholderText="BLOB, CLOB, XML"/>
        </GroupBox>
        
        <!-- Status/Info -->
        <TextBlock Grid.Row="5" x:Name="StatusText" Text="" FontSize="11" Foreground="Gray" 
                   Margin="0,0,0,10" TextWrapping="Wrap"/>
        
        <!-- Buttons -->
        <StackPanel Grid.Row="6" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="OK" Click="OK_Click" Padding="12,6" Margin="0,0,10,0" 
                    IsDefault="True" Width="100"/>
            <Button Content="Cancel" Click="Cancel_Click" Padding="12,6" IsCancel="True" Width="100"/>
        </StackPanel>
    </Grid>
</Window>

<UserControl x:Class="WindowsDb2Editor.Controls.DatabaseLoadMonitorPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ui="http://schemas.modernwpf.com/2019">
    
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>  <!-- Filters -->
            <RowDefinition Height="Auto"/>  <!-- Stats Summary -->
            <RowDefinition Height="*"/>     <!-- Data Grid -->
            <RowDefinition Height="Auto"/>  <!-- Action Buttons -->
        </Grid.RowDefinitions>
        
        <!-- Filter Section -->
        <GroupBox Grid.Row="0" Header="Filters" Margin="0,0,0,10">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <!-- Schema Filter -->
                <TextBlock Grid.Row="0" Grid.Column="0" 
                           Text="Schema:" 
                           VerticalAlignment="Center" 
                           Margin="0,0,10,0"/>
                <ComboBox Grid.Row="0" Grid.Column="1" 
                          x:Name="SchemaComboBox"
                          SelectedIndex="0"
                          SelectionChanged="SchemaComboBox_SelectionChanged"
                          ToolTip="Select schema (* = all schemas)"/>
                
                <!-- Table Filter -->
                <TextBlock Grid.Row="0" Grid.Column="3" 
                           Text="Table:" 
                           VerticalAlignment="Center" 
                           Margin="0,0,10,0"/>
                <ComboBox Grid.Row="0" Grid.Column="4" 
                          x:Name="TableComboBox"
                          SelectedIndex="0"
                          ToolTip="Select table (* = all tables)"/>
                
                <!-- Exclude System Schemas Checkbox -->
                <CheckBox Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="5"
                          x:Name="ExcludeSystemCheckBox"
                          Content="Exclude System Schemas (SYSCAT, SYSIBM, etc.)"
                          IsChecked="True"
                          Margin="0,10,0,0"/>
                
                <!-- Refresh Button -->
                <Button Grid.Row="0" Grid.Column="6" 
                        x:Name="RefreshButton"
                        Content="ðŸ”„ Refresh"
                        Click="RefreshButton_Click"
                        HorizontalAlignment="Right"
                        Padding="15,5"
                        ToolTip="Refresh activity data (F5)"/>
            </Grid>
        </GroupBox>
        
        <!-- Summary Statistics -->
        <Border Grid.Row="1" 
                Background="{DynamicResource SystemControlBackgroundAccentBrush}"
                CornerRadius="5"
                Padding="10"
                Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Total Tables" FontSize="10" Opacity="0.8"/>
                    <TextBlock x:Name="TotalTablesText" Text="0" FontSize="18" FontWeight="Bold"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1">
                    <TextBlock Text="Total Reads" FontSize="10" Opacity="0.8"/>
                    <TextBlock x:Name="TotalReadsText" Text="0" FontSize="18" FontWeight="Bold"/>
                </StackPanel>
                
                <StackPanel Grid.Column="2">
                    <TextBlock Text="Total Inserts" FontSize="10" Opacity="0.8"/>
                    <TextBlock x:Name="TotalInsertsText" Text="0" FontSize="18" FontWeight="Bold"/>
                </StackPanel>
                
                <StackPanel Grid.Column="3">
                    <TextBlock Text="Total Updates" FontSize="10" Opacity="0.8"/>
                    <TextBlock x:Name="TotalUpdatesText" Text="0" FontSize="18" FontWeight="Bold"/>
                </StackPanel>
                
                <StackPanel Grid.Column="4">
                    <TextBlock Text="Total Deletes" FontSize="10" Opacity="0.8"/>
                    <TextBlock x:Name="TotalDeletesText" Text="0" FontSize="18" FontWeight="Bold"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Activity Data Grid -->
        <DataGrid Grid.Row="2" 
                  x:Name="ActivityDataGrid"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  SelectionMode="Extended"
                  GridLinesVisibility="Horizontal"
                  AlternatingRowBackground="{DynamicResource SystemControlBackgroundListLowBrush}"
                  CanUserSortColumns="True">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Schema" Binding="{Binding TabSchema}" Width="150"/>
                <DataGridTextColumn Header="Table" Binding="{Binding TabName}" Width="200"/>
                <DataGridTextColumn Header="Rows Read" Binding="{Binding TotalRowsRead, StringFormat=N0}" Width="120">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Rows Inserted" Binding="{Binding TotalRowsInserted, StringFormat=N0}" Width="120">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Rows Updated" Binding="{Binding TotalRowsUpdated, StringFormat=N0}" Width="120">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Rows Deleted" Binding="{Binding TotalRowsDeleted, StringFormat=N0}" Width="120">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Total Activity" Binding="{Binding TotalActivity, StringFormat=N0}" Width="120">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Read %" Binding="{Binding ReadPercentage, StringFormat=F1}" Width="80">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Write %" Binding="{Binding WritePercentage, StringFormat=F1}" Width="80">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Activity Level" Binding="{Binding ActivityLevel}" Width="100">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Center"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ActivityLevel}" Value="High">
                                    <Setter Property="Foreground" Value="Red"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding ActivityLevel}" Value="Medium">
                                    <Setter Property="Foreground" Value="Orange"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding ActivityLevel}" Value="Low">
                                    <Setter Property="Foreground" Value="Green"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
            </DataGrid.Columns>
        </DataGrid>
        
        <!-- Action Buttons -->
        <StackPanel Grid.Row="3" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right" 
                    Margin="0,10,0,0">
            <TextBlock x:Name="StatusText" 
                       VerticalAlignment="Center" 
                       Margin="0,0,20,0"
                       Text="Ready"/>
            <Button x:Name="ExportButton" 
                    Content="ðŸ“Š Export to CSV" 
                    Click="ExportButton_Click"
                    Padding="10,5"
                    Margin="5,0"
                    ToolTip="Export activity data to CSV file"/>
            <Button x:Name="AutoRefreshButton" 
                    Content="â±ï¸ Auto-Refresh: OFF" 
                    Click="AutoRefreshButton_Click"
                    Padding="10,5"
                    Margin="5,0"
                    ToolTip="Toggle auto-refresh (every 10 seconds)"/>
        </StackPanel>
    </Grid>
</UserControl>

